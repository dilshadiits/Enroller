(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,17378,e=>{"use strict";var s=e.i(43476),t=e.i(71645);let a=["NEW","CONTACTED","INTERESTED","ENROLLED","CLOSED","LOST"];function l(){let[e,l]=(0,t.useState)([]),[n,d]=(0,t.useState)(null),[i,r]=(0,t.useState)(!0),[c,o]=(0,t.useState)(!1),[h,m]=(0,t.useState)("ALL"),[u,x]=(0,t.useState)({status:"",notes:""});(0,t.useEffect)(()=>{j()},[]);let j=async()=>{try{let e=await fetch("/api/leads");if(e.ok){let s=await e.json();l(s.leads)}}catch(e){console.error("Failed to fetch leads:",e)}finally{r(!1)}},p=async()=>{if(n){o(!0);try{let s=await fetch(`/api/leads/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(s.ok){let t=await s.json();l(e.map(e=>e.id===n.id?{...e,...t.lead}:e)),d(null),alert("Lead updated successfully!")}else{let e=await s.json();alert(e.error||"Failed to update lead")}}catch(e){alert("Failed to update lead")}finally{o(!1)}}},g="ALL"===h?e:e.filter(e=>e.status===h);return i?(0,s.jsx)("div",{className:"flex-center",style:{padding:"4rem"},children:(0,s.jsx)("div",{className:"spinner"})}):(0,s.jsxs)("div",{className:"fade-in",children:[(0,s.jsxs)("div",{className:"page-header",children:[(0,s.jsx)("h1",{className:"page-title",children:"Incoming Leads"}),(0,s.jsx)("p",{className:"page-subtitle",children:"Process and update lead statuses"})]}),(0,s.jsxs)("div",{className:"flex gap-sm",style:{marginBottom:"var(--spacing-xl)",flexWrap:"wrap"},children:[(0,s.jsxs)("button",{className:`btn btn-sm ${"ALL"===h?"btn-primary":"btn-secondary"}`,onClick:()=>m("ALL"),children:["All (",e.length,")"]}),a.map(t=>(0,s.jsxs)("button",{className:`btn btn-sm ${h===t?"btn-primary":"btn-secondary"}`,onClick:()=>m(t),children:[t," (",e.filter(e=>e.status===t).length,")"]},t))]}),(0,s.jsx)("div",{className:"card",children:0===g.length?(0,s.jsxs)("div",{className:"empty-state",children:[(0,s.jsx)("div",{className:"empty-state-icon",children:"ðŸ“‹"}),(0,s.jsxs)("p",{children:["No leads found ","ALL"!==h?`with status "${h}"`:""]})]}):(0,s.jsx)("div",{className:"table-container",children:(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Student"}),(0,s.jsx)("th",{children:"Contact"}),(0,s.jsx)("th",{children:"Course"}),(0,s.jsx)("th",{children:"Agent"}),(0,s.jsx)("th",{children:"Status"}),(0,s.jsx)("th",{children:"Date"}),(0,s.jsx)("th",{children:"Action"})]})}),(0,s.jsx)("tbody",{children:g.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{style:{fontWeight:500},children:e.studentName}),(0,s.jsxs)("td",{children:[(0,s.jsx)("div",{children:e.phone}),e.email&&(0,s.jsx)("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:e.email})]}),(0,s.jsxs)("td",{children:[(0,s.jsx)("div",{children:e.course?.name||"N/A"}),(0,s.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--secondary)"},children:["â‚¹",e.course?.fee?.toLocaleString()||"N/A"]})]}),(0,s.jsx)("td",{children:e.agent?.name||"N/A"}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:`badge badge-${e.status.toLowerCase()}`,children:e.status})}),(0,s.jsx)("td",{style:{color:"var(--text-muted)"},children:new Date(e.createdAt).toLocaleDateString()}),(0,s.jsx)("td",{children:(0,s.jsx)("button",{onClick:()=>{d(e),x({status:e.status,notes:e.notes||""})},className:"btn btn-primary btn-sm",children:"Update"})})]},e.id))})]})})}),n&&(0,s.jsx)("div",{className:"modal-overlay",onClick:()=>d(null),children:(0,s.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h2",{children:"Update Lead"}),(0,s.jsx)("button",{className:"modal-close",onClick:()=>d(null),children:"Ã—"})]}),(0,s.jsxs)("div",{style:{marginBottom:"var(--spacing-lg)"},children:[(0,s.jsxs)("div",{style:{padding:"var(--spacing-md)",background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)",marginBottom:"var(--spacing-md)"},children:[(0,s.jsx)("div",{style:{fontWeight:600},children:n.studentName}),(0,s.jsxs)("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:[n.phone," â€¢ ",n.course?.name]})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"status",children:"Status"}),(0,s.jsx)("select",{id:"status",value:u.status,onChange:e=>x({...u,status:e.target.value}),children:a.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"notes",children:"Notes"}),(0,s.jsx)("textarea",{id:"notes",placeholder:"Add follow-up notes...",value:u.notes,onChange:e=>x({...u,notes:e.target.value}),rows:3})]}),"CLOSED"===u.status&&(0,s.jsx)("div",{className:"alert alert-success",children:"âœ¨ Closing this lead will generate a commission for the agent!"})]}),(0,s.jsxs)("div",{className:"flex gap-md",children:[(0,s.jsx)("button",{onClick:()=>d(null),className:"btn btn-secondary",style:{flex:1},children:"Cancel"}),(0,s.jsx)("button",{onClick:p,className:"btn btn-primary",style:{flex:1},disabled:c,children:c?"Updating...":"Save Changes"})]})]})})]})}e.s(["default",()=>l])}]);