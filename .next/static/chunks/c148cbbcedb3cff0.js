(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,48268,e=>{"use strict";var s=e.i(43476),a=e.i(71645);function l(){let[e,l]=(0,a.useState)([]),[r,t]=(0,a.useState)(!0),[n,i]=(0,a.useState)("ALL"),[d,c]=(0,a.useState)(!1),[o,h]=(0,a.useState)(null),[m,p]=(0,a.useState)(!1),[u,x]=(0,a.useState)(""),[j,v]=(0,a.useState)(""),[N,g]=(0,a.useState)({name:"",email:"",password:"",role:"AGENT",phone:""});(0,a.useEffect)(()=>{b()},[]);let b=async()=>{try{let e=await fetch("/api/users");if(e.ok){let s=await e.json();l(s.users)}}catch(e){console.error("Failed to fetch users:",e)}finally{t(!1)}},f=async e=>{e.preventDefault(),x(""),p(!0);try{let e=o?`/api/users/${o.id}`:"/api/users",s=o?"PUT":"POST",a={...N};o&&!a.password&&delete a.password;let l=await fetch(e,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),r=await l.json();if(!l.ok)throw Error(r.error||"Operation failed");v(o?`User ${N.name} updated successfully!`:`User ${N.name} created successfully!`),g({name:"",email:"",password:"",role:"AGENT",phone:""}),c(!1),h(null),b(),setTimeout(()=>v(""),3e3)}catch(e){x(e instanceof Error?e.message:"Operation failed")}finally{p(!1)}},y=async e=>{if(confirm(`Are you sure you want to delete ${e.name}? This action cannot be undone.`))try{let s=await fetch(`/api/users/${e.id}`,{method:"DELETE"}),a=await s.json();if(!s.ok)throw Error(a.error||"Failed to delete user");v(`User ${e.name} deleted successfully!`),b(),setTimeout(()=>v(""),3e3)}catch(e){x(e instanceof Error?e.message:"Failed to delete user"),setTimeout(()=>x(""),3e3)}},w="ALL"===n?e:e.filter(e=>e.role===n);return r?(0,s.jsx)("div",{className:"flex-center",style:{padding:"4rem"},children:(0,s.jsx)("div",{className:"spinner"})}):(0,s.jsxs)("div",{className:"fade-in",children:[(0,s.jsxs)("div",{className:"page-header flex-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"page-title",children:"User Management"}),(0,s.jsx)("p",{className:"page-subtitle",children:"Manage agents, centers, and admins"})]}),(0,s.jsx)("button",{onClick:()=>{h(null),g({name:"",email:"",password:"",role:"AGENT",phone:""}),x(""),c(!0)},className:"btn btn-primary ripple",children:"âž• Create User"})]}),j&&(0,s.jsx)("div",{className:"alert alert-success",children:j}),u&&!d&&(0,s.jsx)("div",{className:"alert alert-error",children:u}),(0,s.jsxs)("div",{className:"grid grid-4",style:{marginBottom:"var(--spacing-xl)"},children:[(0,s.jsxs)("div",{className:"stat-card hover-pop",children:[(0,s.jsx)("div",{className:"stat-value",children:e.length}),(0,s.jsx)("div",{className:"stat-label",children:"Total Users"})]}),(0,s.jsxs)("div",{className:"stat-card hover-pop",children:[(0,s.jsx)("div",{className:"stat-value",style:{color:"var(--primary-light)"},children:e.filter(e=>"AGENT"===e.role).length}),(0,s.jsx)("div",{className:"stat-label",children:"Agents"})]}),(0,s.jsxs)("div",{className:"stat-card hover-pop",children:[(0,s.jsx)("div",{className:"stat-value",style:{color:"var(--secondary)"},children:e.filter(e=>"CENTER"===e.role).length}),(0,s.jsx)("div",{className:"stat-label",children:"Centers"})]}),(0,s.jsxs)("div",{className:"stat-card hover-pop",children:[(0,s.jsx)("div",{className:"stat-value",style:{color:"var(--accent)"},children:e.filter(e=>"ADMIN"===e.role).length}),(0,s.jsx)("div",{className:"stat-label",children:"Admins"})]})]}),(0,s.jsx)("div",{className:"flex gap-sm",style:{marginBottom:"var(--spacing-xl)"},children:["ALL","AGENT","CENTER","ADMIN"].map(e=>(0,s.jsx)("button",{className:`btn btn-sm ${n===e?"btn-primary":"btn-secondary"}`,onClick:()=>i(e),children:e},e))}),(0,s.jsx)("div",{className:"card",children:(0,s.jsx)("div",{className:"table-container",children:(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Name"}),(0,s.jsx)("th",{children:"Email"}),(0,s.jsx)("th",{children:"Phone"}),(0,s.jsx)("th",{children:"Role"}),(0,s.jsx)("th",{children:"Joined"}),(0,s.jsx)("th",{children:"Actions"})]})}),(0,s.jsx)("tbody",{children:w.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{style:{fontWeight:500},children:e.name}),(0,s.jsx)("td",{children:e.email}),(0,s.jsx)("td",{children:e.phone||"-"}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:`badge badge-${"ADMIN"===e.role?"contacted":"CENTER"===e.role?"interested":"new"}`,children:e.role})}),(0,s.jsx)("td",{style:{color:"var(--text-muted)"},children:new Date(e.createdAt).toLocaleDateString()}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{className:"flex gap-sm",children:[(0,s.jsx)("button",{onClick:()=>{h(e),g({name:e.name,email:e.email,password:"",role:e.role,phone:e.phone||""}),x(""),c(!0)},className:"btn btn-sm btn-secondary",title:"Edit User",children:"âœï¸"}),(0,s.jsx)("button",{onClick:()=>y(e),className:"btn btn-sm btn-danger",title:"Delete User",children:"ðŸ—‘ï¸"})]})})]},e.id))})]})})}),d&&(0,s.jsx)("div",{className:"modal-overlay",onClick:()=>c(!1),children:(0,s.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h2",{children:o?"Edit User":"Create New User"}),(0,s.jsx)("button",{className:"modal-close",onClick:()=>c(!1),children:"Ã—"})]}),u&&(0,s.jsx)("div",{className:"alert alert-error",children:u}),(0,s.jsxs)("form",{onSubmit:f,children:[(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"name",children:"Full Name"}),(0,s.jsx)("input",{id:"name",type:"text",placeholder:"John Doe",value:N.name,onChange:e=>g({...N,name:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{className:"form-row",children:[(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,s.jsx)("input",{id:"email",type:"email",placeholder:"user@example.com",value:N.email,onChange:e=>g({...N,email:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"phone",children:"Phone Number"}),(0,s.jsx)("input",{id:"phone",type:"tel",placeholder:"+91 9876543210",value:N.phone,onChange:e=>g({...N,phone:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"form-row",children:[(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"password",children:o?"New Password (leave blank to keep)":"Password"}),(0,s.jsx)("input",{id:"password",type:"password",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:N.password,onChange:e=>g({...N,password:e.target.value}),required:!o,minLength:6})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"role",children:"Role"}),(0,s.jsxs)("select",{id:"role",value:N.role,onChange:e=>g({...N,role:e.target.value}),required:!0,children:[(0,s.jsx)("option",{value:"AGENT",children:"Admission Agent"}),(0,s.jsx)("option",{value:"CENTER",children:"Training Center"}),(0,s.jsx)("option",{value:"ADMIN",children:"Admin"})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-md",style:{marginTop:"var(--spacing-lg)"},children:[(0,s.jsx)("button",{type:"button",onClick:()=>c(!1),className:"btn btn-secondary",style:{flex:1},children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary ripple",style:{flex:1},disabled:m,children:m?o?"Updating...":"Creating...":o?"âœ“ Update User":"âœ“ Create User"})]})]})]})})]})}e.s(["default",()=>l])}]);