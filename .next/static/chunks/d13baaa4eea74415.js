(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,13597,e=>{"use strict";var s=e.i(43476),t=e.i(71645);function a(){let[e,a]=(0,t.useState)([]),[i,l]=(0,t.useState)([]),[r,d]=(0,t.useState)({total:0,pending:0,approved:0,paid:0}),[c,n]=(0,t.useState)([]),[o,m]=(0,t.useState)(!0),[h,u]=(0,t.useState)(!1);(0,t.useEffect)(()=>{x()},[]);let x=async()=>{try{let[e,s]=await Promise.all([fetch("/api/commissions"),fetch("/api/payouts")]);if(e.ok){let s=await e.json();a(s.commissions),d(s.totals)}if(s.ok){let e=await s.json();l(e.payouts)}}catch(e){console.error("Failed to fetch data:",e)}finally{m(!1)}},g=async()=>{if(0!==c.length){u(!0);try{let e=await fetch("/api/payouts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({commissionIds:c})});if(e.ok)n([]),x(),alert("Payout request submitted successfully!");else{let s=await e.json();alert(s.error||"Failed to submit payout request")}}catch(e){alert("Failed to submit payout request")}finally{u(!1)}}},j=e.filter(e=>c.includes(e.id)).reduce((e,s)=>e+s.amount,0);return o?(0,s.jsx)("div",{className:"flex-center",style:{padding:"4rem"},children:(0,s.jsx)("div",{className:"spinner"})}):(0,s.jsxs)("div",{className:"fade-in",children:[(0,s.jsxs)("div",{className:"page-header",children:[(0,s.jsx)("h1",{className:"page-title",children:"Commissions"}),(0,s.jsx)("p",{className:"page-subtitle",children:"Track your earnings and request payouts"})]}),(0,s.jsxs)("div",{className:"grid grid-4",style:{marginBottom:"var(--spacing-xl)"},children:[(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsxs)("div",{className:"stat-value",children:["â‚¹",r.total.toLocaleString()]}),(0,s.jsx)("div",{className:"stat-label",children:"Total Earned"})]}),(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsxs)("div",{className:"stat-value",style:{color:"var(--accent)"},children:["â‚¹",r.pending.toLocaleString()]}),(0,s.jsx)("div",{className:"stat-label",children:"Available for Payout"})]}),(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsxs)("div",{className:"stat-value",style:{color:"var(--primary-light)"},children:["â‚¹",r.approved.toLocaleString()]}),(0,s.jsx)("div",{className:"stat-label",children:"Processing"})]}),(0,s.jsxs)("div",{className:"stat-card",children:[(0,s.jsxs)("div",{className:"stat-value",style:{color:"var(--secondary)"},children:["â‚¹",r.paid.toLocaleString()]}),(0,s.jsx)("div",{className:"stat-label",children:"Paid Out"})]})]}),(0,s.jsxs)("div",{className:"grid",style:{gridTemplateColumns:"2fr 1fr",gap:"var(--spacing-xl)"},children:[(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"card-header",children:[(0,s.jsx)("h3",{className:"card-title",children:"Commission History"}),e.some(e=>"PENDING"===e.status)&&(0,s.jsx)("button",{onClick:()=>{n(e.filter(e=>"PENDING"===e.status).map(e=>e.id))},className:"btn btn-secondary btn-sm",children:"Select All Pending"})]}),0===e.length?(0,s.jsxs)("div",{className:"empty-state",children:[(0,s.jsx)("div",{className:"empty-state-icon",children:"ðŸ’°"}),(0,s.jsx)("p",{children:"No commissions yet. Earn by closing leads!"})]}):(0,s.jsx)("div",{className:"table-container",children:(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{style:{width:"40px"}}),(0,s.jsx)("th",{children:"Student"}),(0,s.jsx)("th",{children:"Course"}),(0,s.jsx)("th",{children:"Amount"}),(0,s.jsx)("th",{children:"Status"}),(0,s.jsx)("th",{children:"Date"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"PENDING"===e.status&&(0,s.jsx)("input",{type:"checkbox",checked:c.includes(e.id),onChange:()=>{var s;return s=e.id,void n(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s])},style:{cursor:"pointer"}})}),(0,s.jsx)("td",{style:{fontWeight:500},children:e.lead?.studentName||"N/A"}),(0,s.jsx)("td",{children:e.course?.name||"N/A"}),(0,s.jsxs)("td",{style:{fontWeight:600,color:"var(--secondary)"},children:["â‚¹",e.amount.toLocaleString()]}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:`badge badge-${e.status.toLowerCase()}`,children:e.status})}),(0,s.jsx)("td",{style:{color:"var(--text-muted)"},children:new Date(e.createdAt).toLocaleDateString()})]},e.id))})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"card",style:{marginBottom:"var(--spacing-lg)"},children:[(0,s.jsx)("h3",{style:{marginBottom:"var(--spacing-lg)"},children:"Request Payout"}),(0,s.jsxs)("div",{style:{padding:"var(--spacing-lg)",background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)",marginBottom:"var(--spacing-lg)"},children:[(0,s.jsx)("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Selected Amount"}),(0,s.jsxs)("div",{className:"commission-amount",children:["â‚¹",j.toLocaleString()]}),(0,s.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"var(--spacing-sm)"},children:[c.length," commission(s) selected"]})]}),(0,s.jsx)("button",{onClick:g,className:"btn btn-success",style:{width:"100%"},disabled:0===c.length||h,children:h?"Submitting...":"Request Payout"})]}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h3",{style:{marginBottom:"var(--spacing-lg)"},children:"Payout History"}),0===i.length?(0,s.jsx)("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:"No payout requests yet"}):(0,s.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:i.slice(0,5).map(e=>(0,s.jsxs)("div",{style:{padding:"var(--spacing-md)",background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)"},children:[(0,s.jsxs)("div",{className:"flex-between",children:[(0,s.jsxs)("span",{style:{fontWeight:600},children:["â‚¹",e.totalAmount.toLocaleString()]}),(0,s.jsx)("span",{className:`badge badge-${e.status.toLowerCase()}`,children:e.status})]}),(0,s.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"var(--spacing-xs)"},children:["Requested: ",new Date(e.requestedAt).toLocaleDateString()]})]},e.id))})]})]})]})]})}e.s(["default",()=>a])}]);