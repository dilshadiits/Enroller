{"version":3,"sources":["../../../../src/app/agent/collect/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface Course {\r\n    id: string;\r\n    name: string;\r\n    fee: number;\r\n    commissionPercent: number;\r\n    center?: { name: string };\r\n}\r\n\r\nexport default function AgentCollectPage() {\r\n    const router = useRouter();\r\n    const [courses, setCourses] = useState<Course[]>([]);\r\n    const [formData, setFormData] = useState({\r\n        studentName: '',\r\n        phone: '',\r\n        email: '',\r\n        courseId: '',\r\n        notes: '',\r\n    });\r\n    const [loading, setLoading] = useState(true);\r\n    const [submitting, setSubmitting] = useState(false);\r\n    const [error, setError] = useState('');\r\n    const [success, setSuccess] = useState(false);\r\n\r\n    useEffect(() => {\r\n        fetchCourses();\r\n    }, []);\r\n\r\n    const fetchCourses = async () => {\r\n        try {\r\n            const res = await fetch('/api/courses');\r\n            if (res.ok) {\r\n                const data = await res.json();\r\n                setCourses(data.courses);\r\n            }\r\n        } catch (err) {\r\n            console.error('Failed to fetch courses:', err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        setSubmitting(true);\r\n\r\n        try {\r\n            const res = await fetch('/api/leads', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(formData),\r\n            });\r\n\r\n            const data = await res.json();\r\n\r\n            if (!res.ok) {\r\n                throw new Error(data.error || 'Failed to add lead');\r\n            }\r\n\r\n            setSuccess(true);\r\n            setFormData({\r\n                studentName: '',\r\n                phone: '',\r\n                email: '',\r\n                courseId: '',\r\n                notes: '',\r\n            });\r\n\r\n            setTimeout(() => {\r\n                setSuccess(false);\r\n            }, 3000);\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'Failed to add lead');\r\n        } finally {\r\n            setSubmitting(false);\r\n        }\r\n    };\r\n\r\n    const selectedCourse = courses.find(c => c.id === formData.courseId);\r\n    const estimatedCommission = selectedCourse\r\n        ? (selectedCourse.fee * selectedCourse.commissionPercent) / 100\r\n        : 0;\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex-center\" style={{ padding: '4rem' }}>\r\n                <div className=\"spinner\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"fade-in\">\r\n            <div className=\"page-header\">\r\n                <h1 className=\"page-title\">Add New Lead</h1>\r\n                <p className=\"page-subtitle\">Manually add a lead to your collection</p>\r\n            </div>\r\n\r\n            <div className=\"grid\" style={{ gridTemplateColumns: '2fr 1fr', gap: 'var(--spacing-xl)' }}>\r\n                {/* Lead Form */}\r\n                <div className=\"card\">\r\n                    {success && (\r\n                        <div className=\"alert alert-success\">\r\n                            ‚úÖ Lead added successfully!\r\n                        </div>\r\n                    )}\r\n\r\n                    {error && (\r\n                        <div className=\"alert alert-error\">{error}</div>\r\n                    )}\r\n\r\n                    <form onSubmit={handleSubmit}>\r\n                        <div className=\"form-row\">\r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"studentName\">Student Name *</label>\r\n                                <input\r\n                                    id=\"studentName\"\r\n                                    type=\"text\"\r\n                                    placeholder=\"Enter student's full name\"\r\n                                    value={formData.studentName}\r\n                                    onChange={(e) => setFormData({ ...formData, studentName: e.target.value })}\r\n                                    required\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"phone\">Phone Number *</label>\r\n                                <input\r\n                                    id=\"phone\"\r\n                                    type=\"tel\"\r\n                                    placeholder=\"+91 9876543210\"\r\n                                    value={formData.phone}\r\n                                    onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\r\n                                    required\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"form-row\">\r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"email\">Email Address</label>\r\n                                <input\r\n                                    id=\"email\"\r\n                                    type=\"email\"\r\n                                    placeholder=\"student@example.com\"\r\n                                    value={formData.email}\r\n                                    onChange={(e) => setFormData({ ...formData, email: e.target.value })}\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"courseId\">Select Course *</label>\r\n                                <select\r\n                                    id=\"courseId\"\r\n                                    value={formData.courseId}\r\n                                    onChange={(e) => setFormData({ ...formData, courseId: e.target.value })}\r\n                                    required\r\n                                >\r\n                                    <option value=\"\">Choose a course</option>\r\n                                    {courses.map(course => (\r\n                                        <option key={course.id} value={course.id}>\r\n                                            {course.name} ({course.center?.name}) - ‚Çπ{course.fee.toLocaleString()}\r\n                                        </option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"form-group\">\r\n                            <label htmlFor=\"notes\">Notes (Optional)</label>\r\n                            <textarea\r\n                                id=\"notes\"\r\n                                placeholder=\"Any additional notes about this lead...\"\r\n                                value={formData.notes}\r\n                                onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\r\n                                rows={3}\r\n                            />\r\n                        </div>\r\n\r\n                        <button\r\n                            type=\"submit\"\r\n                            className=\"btn btn-primary\"\r\n                            style={{ marginTop: 'var(--spacing-md)' }}\r\n                            disabled={submitting}\r\n                        >\r\n                            {submitting ? 'Adding Lead...' : '‚ûï Add Lead'}\r\n                        </button>\r\n                    </form>\r\n                </div>\r\n\r\n                {/* Commission Preview */}\r\n                <div>\r\n                    <div className=\"card\" style={{ position: 'sticky', top: '100px' }}>\r\n                        <h3 style={{ marginBottom: 'var(--spacing-lg)' }}>Commission Preview</h3>\r\n\r\n                        {selectedCourse ? (\r\n                            <div>\r\n                                <div style={{ marginBottom: 'var(--spacing-lg)' }}>\r\n                                    <div style={{ fontSize: '0.875rem', color: 'var(--text-muted)' }}>\r\n                                        Selected Course\r\n                                    </div>\r\n                                    <div style={{ fontWeight: 600 }}>{selectedCourse.name}</div>\r\n                                </div>\r\n\r\n                                <div style={{ marginBottom: 'var(--spacing-lg)' }}>\r\n                                    <div style={{ fontSize: '0.875rem', color: 'var(--text-muted)' }}>\r\n                                        Lead Goes To Center\r\n                                    </div>\r\n                                    <div style={{\r\n                                        fontWeight: 600,\r\n                                        color: 'var(--primary-light)',\r\n                                        display: 'flex',\r\n                                        alignItems: 'center',\r\n                                        gap: '0.5rem'\r\n                                    }}>\r\n                                        üè¢ {selectedCourse.center?.name || 'N/A'}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div style={{ marginBottom: 'var(--spacing-lg)' }}>\r\n                                    <div style={{ fontSize: '0.875rem', color: 'var(--text-muted)' }}>\r\n                                        Course Fee\r\n                                    </div>\r\n                                    <div style={{ fontWeight: 600 }}>‚Çπ{selectedCourse.fee.toLocaleString()}</div>\r\n                                </div>\r\n\r\n                                <div style={{ marginBottom: 'var(--spacing-lg)' }}>\r\n                                    <div style={{ fontSize: '0.875rem', color: 'var(--text-muted)' }}>\r\n                                        Commission Rate\r\n                                    </div>\r\n                                    <div style={{ fontWeight: 600 }}>{selectedCourse.commissionPercent}%</div>\r\n                                </div>\r\n\r\n                                <div style={{\r\n                                    padding: 'var(--spacing-lg)',\r\n                                    background: 'linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(16, 185, 129, 0.1) 100%)',\r\n                                    borderRadius: 'var(--radius-md)',\r\n                                    textAlign: 'center'\r\n                                }}>\r\n                                    <div style={{ fontSize: '0.875rem', color: 'var(--secondary)' }}>\r\n                                        You&apos;ll Earn\r\n                                    </div>\r\n                                    <div style={{ fontSize: '2rem', fontWeight: 700, color: 'var(--secondary)' }}>\r\n                                        ‚Çπ{estimatedCommission.toLocaleString()}\r\n                                    </div>\r\n                                    <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>\r\n                                        on successful enrollment\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        ) : (\r\n                            <div style={{ textAlign: 'center', color: 'var(--text-muted)' }}>\r\n                                <p>Select a course to see your commission</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}