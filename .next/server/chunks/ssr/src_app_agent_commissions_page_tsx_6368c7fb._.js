module.exports=[10276,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d(){let[a,d]=(0,c.useState)([]),[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)({total:0,pending:0,approved:0,paid:0}),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(!1);(0,c.useEffect)(()=>{o()},[]);let o=async()=>{try{let[a,b]=await Promise.all([fetch("/api/commissions"),fetch("/api/payouts")]);if(a.ok){let b=await a.json();d(b.commissions),h(b.totals)}if(b.ok){let a=await b.json();f(a.payouts)}}catch(a){console.error("Failed to fetch data:",a)}finally{l(!1)}},p=async()=>{if(0!==i.length){n(!0);try{let a=await fetch("/api/payouts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({commissionIds:i})});if(a.ok)j([]),o(),alert("Payout request submitted successfully!");else{let b=await a.json();alert(b.error||"Failed to submit payout request")}}catch(a){alert("Failed to submit payout request")}finally{n(!1)}}},q=a.filter(a=>i.includes(a.id)).reduce((a,b)=>a+b.amount,0);return k?(0,b.jsx)("div",{className:"flex-center",style:{padding:"4rem"},children:(0,b.jsx)("div",{className:"spinner"})}):(0,b.jsxs)("div",{className:"fade-in",children:[(0,b.jsxs)("div",{className:"page-header",children:[(0,b.jsx)("h1",{className:"page-title",children:"Commissions"}),(0,b.jsx)("p",{className:"page-subtitle",children:"Track your earnings and request payouts"})]}),(0,b.jsxs)("div",{className:"grid grid-4",style:{marginBottom:"var(--spacing-xl)"},children:[(0,b.jsxs)("div",{className:"stat-card",children:[(0,b.jsxs)("div",{className:"stat-value",children:["â‚¹",g.total.toLocaleString()]}),(0,b.jsx)("div",{className:"stat-label",children:"Total Earned"})]}),(0,b.jsxs)("div",{className:"stat-card",children:[(0,b.jsxs)("div",{className:"stat-value",style:{color:"var(--accent)"},children:["â‚¹",g.pending.toLocaleString()]}),(0,b.jsx)("div",{className:"stat-label",children:"Available for Payout"})]}),(0,b.jsxs)("div",{className:"stat-card",children:[(0,b.jsxs)("div",{className:"stat-value",style:{color:"var(--primary-light)"},children:["â‚¹",g.approved.toLocaleString()]}),(0,b.jsx)("div",{className:"stat-label",children:"Processing"})]}),(0,b.jsxs)("div",{className:"stat-card",children:[(0,b.jsxs)("div",{className:"stat-value",style:{color:"var(--secondary)"},children:["â‚¹",g.paid.toLocaleString()]}),(0,b.jsx)("div",{className:"stat-label",children:"Paid Out"})]})]}),(0,b.jsxs)("div",{className:"grid",style:{gridTemplateColumns:"2fr 1fr",gap:"var(--spacing-xl)"},children:[(0,b.jsxs)("div",{className:"card",children:[(0,b.jsxs)("div",{className:"card-header",children:[(0,b.jsx)("h3",{className:"card-title",children:"Commission History"}),a.some(a=>"PENDING"===a.status)&&(0,b.jsx)("button",{onClick:()=>{j(a.filter(a=>"PENDING"===a.status).map(a=>a.id))},className:"btn btn-secondary btn-sm",children:"Select All Pending"})]}),0===a.length?(0,b.jsxs)("div",{className:"empty-state",children:[(0,b.jsx)("div",{className:"empty-state-icon",children:"ðŸ’°"}),(0,b.jsx)("p",{children:"No commissions yet. Earn by closing leads!"})]}):(0,b.jsx)("div",{className:"table-container",children:(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{style:{width:"40px"}}),(0,b.jsx)("th",{children:"Student"}),(0,b.jsx)("th",{children:"Course"}),(0,b.jsx)("th",{children:"Amount"}),(0,b.jsx)("th",{children:"Status"}),(0,b.jsx)("th",{children:"Date"})]})}),(0,b.jsx)("tbody",{children:a.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"PENDING"===a.status&&(0,b.jsx)("input",{type:"checkbox",checked:i.includes(a.id),onChange:()=>{var b;return b=a.id,void j(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},style:{cursor:"pointer"}})}),(0,b.jsx)("td",{style:{fontWeight:500},children:a.lead?.studentName||"N/A"}),(0,b.jsx)("td",{children:a.course?.name||"N/A"}),(0,b.jsxs)("td",{style:{fontWeight:600,color:"var(--secondary)"},children:["â‚¹",a.amount.toLocaleString()]}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:`badge badge-${a.status.toLowerCase()}`,children:a.status})}),(0,b.jsx)("td",{style:{color:"var(--text-muted)"},children:new Date(a.createdAt).toLocaleDateString()})]},a.id))})]})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"card",style:{marginBottom:"var(--spacing-lg)"},children:[(0,b.jsx)("h3",{style:{marginBottom:"var(--spacing-lg)"},children:"Request Payout"}),(0,b.jsxs)("div",{style:{padding:"var(--spacing-lg)",background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)",marginBottom:"var(--spacing-lg)"},children:[(0,b.jsx)("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Selected Amount"}),(0,b.jsxs)("div",{className:"commission-amount",children:["â‚¹",q.toLocaleString()]}),(0,b.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"var(--spacing-sm)"},children:[i.length," commission(s) selected"]})]}),(0,b.jsx)("button",{onClick:p,className:"btn btn-success",style:{width:"100%"},disabled:0===i.length||m,children:m?"Submitting...":"Request Payout"})]}),(0,b.jsxs)("div",{className:"card",children:[(0,b.jsx)("h3",{style:{marginBottom:"var(--spacing-lg)"},children:"Payout History"}),0===e.length?(0,b.jsx)("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:"No payout requests yet"}):(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:e.slice(0,5).map(a=>(0,b.jsxs)("div",{style:{padding:"var(--spacing-md)",background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)"},children:[(0,b.jsxs)("div",{className:"flex-between",children:[(0,b.jsxs)("span",{style:{fontWeight:600},children:["â‚¹",a.totalAmount.toLocaleString()]}),(0,b.jsx)("span",{className:`badge badge-${a.status.toLowerCase()}`,children:a.status})]}),(0,b.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"var(--spacing-xs)"},children:["Requested: ",new Date(a.requestedAt).toLocaleDateString()]})]},a.id))})]})]})]})]})}a.s(["default",()=>d])}];

//# sourceMappingURL=src_app_agent_commissions_page_tsx_6368c7fb._.js.map