module.exports=[80374,a=>{"use strict";var b=a.i(87924),c=a.i(72131);let d=["NEW","CONTACTED","INTERESTED","ENROLLED","CLOSED","LOST"];function e(){let[a,e]=(0,c.useState)([]),[f,g]=(0,c.useState)(null),[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)("ALL"),[n,o]=(0,c.useState)({status:"",notes:""});(0,c.useEffect)(()=>{p()},[]);let p=async()=>{try{let a=await fetch("/api/leads");if(a.ok){let b=await a.json();e(b.leads)}}catch(a){console.error("Failed to fetch leads:",a)}finally{i(!1)}},q=async()=>{if(f){k(!0);try{let b=await fetch(`/api/leads/${f.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(b.ok){let c=await b.json();e(a.map(a=>a.id===f.id?{...a,...c.lead}:a)),g(null),alert("Lead updated successfully!")}else{let a=await b.json();alert(a.error||"Failed to update lead")}}catch(a){alert("Failed to update lead")}finally{k(!1)}}},r="ALL"===l?a:a.filter(a=>a.status===l);return h?(0,b.jsx)("div",{className:"flex-center",style:{padding:"4rem"},children:(0,b.jsx)("div",{className:"spinner"})}):(0,b.jsxs)("div",{className:"fade-in",children:[(0,b.jsxs)("div",{className:"page-header",children:[(0,b.jsx)("h1",{className:"page-title",children:"Incoming Leads"}),(0,b.jsx)("p",{className:"page-subtitle",children:"Process and update lead statuses"})]}),(0,b.jsxs)("div",{className:"flex gap-sm",style:{marginBottom:"var(--spacing-xl)",flexWrap:"wrap"},children:[(0,b.jsxs)("button",{className:`btn btn-sm ${"ALL"===l?"btn-primary":"btn-secondary"}`,onClick:()=>m("ALL"),children:["All (",a.length,")"]}),d.map(c=>(0,b.jsxs)("button",{className:`btn btn-sm ${l===c?"btn-primary":"btn-secondary"}`,onClick:()=>m(c),children:[c," (",a.filter(a=>a.status===c).length,")"]},c))]}),(0,b.jsx)("div",{className:"card",children:0===r.length?(0,b.jsxs)("div",{className:"empty-state",children:[(0,b.jsx)("div",{className:"empty-state-icon",children:"ðŸ“‹"}),(0,b.jsxs)("p",{children:["No leads found ","ALL"!==l?`with status "${l}"`:""]})]}):(0,b.jsx)("div",{className:"table-container",children:(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Student"}),(0,b.jsx)("th",{children:"Contact"}),(0,b.jsx)("th",{children:"Course"}),(0,b.jsx)("th",{children:"Agent"}),(0,b.jsx)("th",{children:"Status"}),(0,b.jsx)("th",{children:"Date"}),(0,b.jsx)("th",{children:"Action"})]})}),(0,b.jsx)("tbody",{children:r.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{style:{fontWeight:500},children:a.studentName}),(0,b.jsxs)("td",{children:[(0,b.jsx)("div",{children:a.phone}),a.email&&(0,b.jsx)("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:a.email})]}),(0,b.jsxs)("td",{children:[(0,b.jsx)("div",{children:a.course?.name||"N/A"}),(0,b.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--secondary)"},children:["â‚¹",a.course?.fee?.toLocaleString()||"N/A"]})]}),(0,b.jsx)("td",{children:a.agent?.name||"N/A"}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:`badge badge-${a.status.toLowerCase()}`,children:a.status})}),(0,b.jsx)("td",{style:{color:"var(--text-muted)"},children:new Date(a.createdAt).toLocaleDateString()}),(0,b.jsx)("td",{children:(0,b.jsx)("button",{onClick:()=>{g(a),o({status:a.status,notes:a.notes||""})},className:"btn btn-primary btn-sm",children:"Update"})})]},a.id))})]})})}),f&&(0,b.jsx)("div",{className:"modal-overlay",onClick:()=>g(null),children:(0,b.jsxs)("div",{className:"modal",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"modal-header",children:[(0,b.jsx)("h2",{children:"Update Lead"}),(0,b.jsx)("button",{className:"modal-close",onClick:()=>g(null),children:"Ã—"})]}),(0,b.jsxs)("div",{style:{marginBottom:"var(--spacing-lg)"},children:[(0,b.jsxs)("div",{style:{padding:"var(--spacing-md)",background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)",marginBottom:"var(--spacing-md)"},children:[(0,b.jsx)("div",{style:{fontWeight:600},children:f.studentName}),(0,b.jsxs)("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:[f.phone," â€¢ ",f.course?.name]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{htmlFor:"status",children:"Status"}),(0,b.jsx)("select",{id:"status",value:n.status,onChange:a=>o({...n,status:a.target.value}),children:d.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{htmlFor:"notes",children:"Notes"}),(0,b.jsx)("textarea",{id:"notes",placeholder:"Add follow-up notes...",value:n.notes,onChange:a=>o({...n,notes:a.target.value}),rows:3})]}),"CLOSED"===n.status&&(0,b.jsx)("div",{className:"alert alert-success",children:"âœ¨ Closing this lead will generate a commission for the agent!"})]}),(0,b.jsxs)("div",{className:"flex gap-md",children:[(0,b.jsx)("button",{onClick:()=>g(null),className:"btn btn-secondary",style:{flex:1},children:"Cancel"}),(0,b.jsx)("button",{onClick:q,className:"btn btn-primary",style:{flex:1},disabled:j,children:j?"Updating...":"Save Changes"})]})]})})]})}a.s(["default",()=>e])}];

//# sourceMappingURL=src_app_center_leads_page_tsx_442429a0._.js.map