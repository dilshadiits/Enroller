{"version":3,"sources":["../../../../src/app/admin/payouts/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\ninterface Payout {\r\n    id: string;\r\n    totalAmount: number;\r\n    status: string;\r\n    requestedAt: string;\r\n    approvedAt?: string;\r\n    paidAt?: string;\r\n    notes?: string;\r\n    agent?: { id: string; name: string; email: string };\r\n}\r\n\r\nexport default function AdminPayoutsPage() {\r\n    const [payouts, setPayouts] = useState<Payout[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [processing, setProcessing] = useState<string | null>(null);\r\n    const [filter, setFilter] = useState('ALL');\r\n\r\n    useEffect(() => {\r\n        fetchPayouts();\r\n    }, []);\r\n\r\n    const fetchPayouts = async () => {\r\n        try {\r\n            console.log('Fetching payouts...');\r\n            const res = await fetch('/api/payouts');\r\n            console.log('Fetch payouts response status:', res.status);\r\n\r\n            if (res.ok) {\r\n                const data = await res.json();\r\n                console.log('Fetch payouts data:', data);\r\n                setPayouts(data.payouts);\r\n            } else {\r\n                const errData = await res.json().catch(() => ({}));\r\n                console.error('Fetch payouts failed:', errData);\r\n                // Optional: alert('Failed to fetch payouts');\r\n            }\r\n        } catch (err) {\r\n            console.error('Failed to fetch payouts:', err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleAction = async (payoutId: string, action: 'APPROVE' | 'REJECT' | 'MARK_PAID') => {\r\n        setProcessing(payoutId);\r\n        try {\r\n            const res = await fetch(`/api/payouts/${payoutId}`, {\r\n                method: 'PUT',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ action }),\r\n            });\r\n\r\n            if (res.ok) {\r\n                fetchPayouts();\r\n            } else {\r\n                const data = await res.json();\r\n                alert(data.error || 'Failed to process payout');\r\n            }\r\n        } catch (err) {\r\n            alert('Failed to process payout');\r\n        } finally {\r\n            setProcessing(null);\r\n        }\r\n    };\r\n\r\n    const filteredPayouts = filter === 'ALL'\r\n        ? payouts\r\n        : payouts.filter(p => p.status === filter);\r\n\r\n    const totals = {\r\n        requested: payouts.filter(p => p.status === 'REQUESTED').reduce((sum, p) => sum + p.totalAmount, 0),\r\n        approved: payouts.filter(p => p.status === 'APPROVED').reduce((sum, p) => sum + p.totalAmount, 0),\r\n        paid: payouts.filter(p => p.status === 'PAID').reduce((sum, p) => sum + p.totalAmount, 0),\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex-center\" style={{ padding: '4rem' }}>\r\n                <div className=\"spinner\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"fade-in\">\r\n            <div className=\"page-header\">\r\n                <h1 className=\"page-title\">Payout Management</h1>\r\n                <p className=\"page-subtitle\">Review and process agent payout requests</p>\r\n            </div>\r\n\r\n            {/* Stats */}\r\n            <div className=\"grid grid-4\" style={{ marginBottom: 'var(--spacing-xl)' }}>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\">{payouts.length}</div>\r\n                    <div className=\"stat-label\">Total Requests</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--accent)' }}>\r\n                        â‚¹{totals.requested.toLocaleString()}\r\n                    </div>\r\n                    <div className=\"stat-label\">Pending Review</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--primary-light)' }}>\r\n                        â‚¹{totals.approved.toLocaleString()}\r\n                    </div>\r\n                    <div className=\"stat-label\">Approved (Unpaid)</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--secondary)' }}>\r\n                        â‚¹{totals.paid.toLocaleString()}\r\n                    </div>\r\n                    <div className=\"stat-label\">Total Paid</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Filters */}\r\n            <div className=\"flex gap-sm\" style={{ marginBottom: 'var(--spacing-xl)' }}>\r\n                {['ALL', 'REQUESTED', 'APPROVED', 'PAID', 'REJECTED'].map(status => (\r\n                    <button\r\n                        key={status}\r\n                        className={`btn btn-sm ${filter === status ? 'btn-primary' : 'btn-secondary'}`}\r\n                        onClick={() => setFilter(status)}\r\n                    >\r\n                        {status} ({payouts.filter(p => status === 'ALL' || p.status === status).length})\r\n                    </button>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Payouts Table */}\r\n            <div className=\"card\">\r\n                {filteredPayouts.length === 0 ? (\r\n                    <div className=\"empty-state\">\r\n                        <div className=\"empty-state-icon\">ðŸ’³</div>\r\n                        <p>No payout requests {filter !== 'ALL' ? `with status \"${filter}\"` : ''}</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"table-container\">\r\n                        <table>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Agent</th>\r\n                                    <th>Amount</th>\r\n                                    <th>Status</th>\r\n                                    <th>Requested</th>\r\n                                    <th>Actions</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {filteredPayouts.map(payout => (\r\n                                    <tr key={payout.id}>\r\n                                        <td>\r\n                                            <div style={{ fontWeight: 500 }}>{payout.agent?.name || 'Unknown'}</div>\r\n                                            <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>\r\n                                                {payout.agent?.email}\r\n                                            </div>\r\n                                        </td>\r\n                                        <td style={{ fontWeight: 600, color: 'var(--secondary)', fontSize: '1.125rem' }}>\r\n                                            â‚¹{payout.totalAmount.toLocaleString()}\r\n                                        </td>\r\n                                        <td>\r\n                                            <span className={`badge badge-${payout.status.toLowerCase()}`}>\r\n                                                {payout.status}\r\n                                            </span>\r\n                                        </td>\r\n                                        <td style={{ color: 'var(--text-muted)' }}>\r\n                                            {new Date(payout.requestedAt).toLocaleDateString()}\r\n                                        </td>\r\n                                        <td>\r\n                                            <div className=\"flex gap-sm\">\r\n                                                {payout.status === 'REQUESTED' && (\r\n                                                    <>\r\n                                                        <button\r\n                                                            onClick={() => handleAction(payout.id, 'APPROVE')}\r\n                                                            className=\"btn btn-success btn-sm\"\r\n                                                            disabled={processing === payout.id}\r\n                                                        >\r\n                                                            Approve\r\n                                                        </button>\r\n                                                        <button\r\n                                                            onClick={() => handleAction(payout.id, 'REJECT')}\r\n                                                            className=\"btn btn-danger btn-sm\"\r\n                                                            disabled={processing === payout.id}\r\n                                                        >\r\n                                                            Reject\r\n                                                        </button>\r\n                                                    </>\r\n                                                )}\r\n                                                {payout.status === 'APPROVED' && (\r\n                                                    <button\r\n                                                        onClick={() => handleAction(payout.id, 'MARK_PAID')}\r\n                                                        className=\"btn btn-primary btn-sm\"\r\n                                                        disabled={processing === payout.id}\r\n                                                    >\r\n                                                        Mark as Paid\r\n                                                    </button>\r\n                                                )}\r\n                                                {payout.status === 'PAID' && (\r\n                                                    <span style={{ color: 'var(--secondary)', fontSize: '0.875rem' }}>\r\n                                                        âœ“ Completed\r\n                                                    </span>\r\n                                                )}\r\n                                                {payout.status === 'REJECTED' && (\r\n                                                    <span style={{ color: 'var(--danger)', fontSize: '0.875rem' }}>\r\n                                                        âœ— Rejected\r\n                                                    </span>\r\n                                                )}\r\n                                            </div>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}