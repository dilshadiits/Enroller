{"version":3,"sources":["../../../../src/app/agent/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\n\r\ninterface Lead {\r\n    id: string;\r\n    studentName: string;\r\n    status: string;\r\n    createdAt: string;\r\n    course?: { name: string };\r\n}\r\n\r\ninterface CommissionTotals {\r\n    total: number;\r\n    pending: number;\r\n    paid: number;\r\n}\r\n\r\nexport default function AgentDashboard() {\r\n    const [leads, setLeads] = useState<Lead[]>([]);\r\n    const [commissionTotals, setCommissionTotals] = useState<CommissionTotals>({ total: 0, pending: 0, paid: 0 });\r\n    const [loading, setLoading] = useState(true);\r\n    const [agentId, setAgentId] = useState('');\r\n    const [origin, setOrigin] = useState('');\r\n\r\n    useEffect(() => {\r\n        setOrigin(window.location.origin);\r\n        fetchData();\r\n    }, []);\r\n\r\n    const fetchData = async () => {\r\n        try {\r\n            const [leadsRes, commissionsRes, meRes] = await Promise.all([\r\n                fetch('/api/leads'),\r\n                fetch('/api/commissions'),\r\n                fetch('/api/auth/me'),\r\n            ]);\r\n\r\n            if (leadsRes.ok) {\r\n                const leadsData = await leadsRes.json();\r\n                setLeads(leadsData.leads);\r\n            }\r\n\r\n            if (commissionsRes.ok) {\r\n                const commissionsData = await commissionsRes.json();\r\n                setCommissionTotals(commissionsData.totals);\r\n            }\r\n\r\n            if (meRes.ok) {\r\n                const meData = await meRes.json();\r\n                setAgentId(meData.user.id);\r\n            }\r\n        } catch (err) {\r\n            console.error('Failed to fetch data:', err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const getStatusCount = (status: string) =>\r\n        leads.filter(l => l.status === status).length;\r\n\r\n    const copyLink = () => {\r\n        const link = `${window.location.origin}/collect/${agentId}`;\r\n        navigator.clipboard.writeText(link);\r\n        alert('Link copied to clipboard!');\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex-center\" style={{ padding: '4rem' }}>\r\n                <div className=\"spinner\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"fade-in\">\r\n            <div className=\"page-header\">\r\n                <h1 className=\"page-title\">Agent Dashboard</h1>\r\n                <p className=\"page-subtitle\">Track your leads and earnings</p>\r\n            </div>\r\n\r\n            {/* Referral Link */}\r\n            <div className=\"card\" style={{ marginBottom: 'var(--spacing-xl)', borderLeft: '3px solid var(--primary)' }}>\r\n                <div className=\"flex-between\" style={{ flexWrap: 'wrap', gap: 'var(--spacing-md)' }}>\r\n                    <div>\r\n                        <h4 style={{ marginBottom: 'var(--spacing-sm)' }}>Your Referral Link</h4>\r\n                        <p style={{ color: 'var(--text-muted)', fontSize: '0.875rem' }}>\r\n                            Share this link to collect leads\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"url-input-group\">\r\n                        <input\r\n                            type=\"text\"\r\n                            value={agentId && origin ? `${origin}/collect/${agentId}` : ''}\r\n                            readOnly\r\n                            style={{ maxWidth: '400px' }}\r\n                        />\r\n                        <button onClick={copyLink} className=\"btn btn-primary btn-sm\">\r\n                            ðŸ“‹ Copy\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Stats Grid */}\r\n            <div className=\"grid grid-4\" style={{ marginBottom: 'var(--spacing-xl)' }}>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\">{leads.length}</div>\r\n                    <div className=\"stat-label\">Total Leads</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--primary-light)' }}>\r\n                        {getStatusCount('NEW') + getStatusCount('CONTACTED') + getStatusCount('INTERESTED')}\r\n                    </div>\r\n                    <div className=\"stat-label\">Active Leads</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--secondary)' }}>\r\n                        {getStatusCount('ENROLLED') + getStatusCount('CLOSED')}\r\n                    </div>\r\n                    <div className=\"stat-label\">Conversions</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\">â‚¹{commissionTotals.total.toLocaleString()}</div>\r\n                    <div className=\"stat-label\">Total Earnings</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Commission Overview */}\r\n            <div className=\"grid grid-3\" style={{ marginBottom: 'var(--spacing-xl)' }}>\r\n                <div className=\"card\" style={{ borderTop: '3px solid var(--accent)' }}>\r\n                    <h4 style={{ color: 'var(--accent)', marginBottom: 'var(--spacing-sm)' }}>Pending</h4>\r\n                    <div className=\"commission-amount\">â‚¹{commissionTotals.pending.toLocaleString()}</div>\r\n                    <p style={{ fontSize: '0.875rem', marginTop: 'var(--spacing-sm)' }}>Awaiting payout</p>\r\n                </div>\r\n                <div className=\"card\" style={{ borderTop: '3px solid var(--secondary)' }}>\r\n                    <h4 style={{ color: 'var(--secondary)', marginBottom: 'var(--spacing-sm)' }}>Paid</h4>\r\n                    <div className=\"commission-amount\" style={{ color: 'var(--secondary)' }}>\r\n                        â‚¹{commissionTotals.paid.toLocaleString()}\r\n                    </div>\r\n                    <p style={{ fontSize: '0.875rem', marginTop: 'var(--spacing-sm)' }}>Successfully withdrawn</p>\r\n                </div>\r\n                <div className=\"card\" style={{ borderTop: '3px solid var(--primary)' }}>\r\n                    <Link href=\"/agent/commissions\" className=\"btn btn-primary\" style={{ width: '100%' }}>\r\n                        ðŸ’° Request Payout\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Recent Leads */}\r\n            <div className=\"card\">\r\n                <div className=\"card-header\">\r\n                    <h3 className=\"card-title\">Recent Leads</h3>\r\n                    <Link href=\"/agent/leads\" className=\"btn btn-secondary btn-sm\">View All</Link>\r\n                </div>\r\n\r\n                {leads.length === 0 ? (\r\n                    <div className=\"empty-state\">\r\n                        <div className=\"empty-state-icon\">ðŸ‘¥</div>\r\n                        <p>No leads yet. Share your referral link to start collecting!</p>\r\n                        <Link href=\"/agent/collect\" className=\"btn btn-primary\" style={{ marginTop: 'var(--spacing-lg)' }}>\r\n                            âž• Add Your First Lead\r\n                        </Link>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"table-container\">\r\n                        <table>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Student Name</th>\r\n                                    <th>Course</th>\r\n                                    <th>Status</th>\r\n                                    <th>Date</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {leads.slice(0, 5).map(lead => (\r\n                                    <tr key={lead.id}>\r\n                                        <td style={{ fontWeight: 500 }}>{lead.studentName}</td>\r\n                                        <td>{lead.course?.name || 'N/A'}</td>\r\n                                        <td>\r\n                                            <span className={`badge badge-${lead.status.toLowerCase()}`}>\r\n                                                {lead.status}\r\n                                            </span>\r\n                                        </td>\r\n                                        <td style={{ color: 'var(--text-muted)' }}>\r\n                                            {new Date(lead.createdAt).toLocaleDateString()}\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}