{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/EDMAN/src/app/admin/payouts/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\ninterface Payout {\r\n    id: string;\r\n    totalAmount: number;\r\n    status: string;\r\n    requestedAt: string;\r\n    approvedAt?: string;\r\n    paidAt?: string;\r\n    notes?: string;\r\n    agent?: { id: string; name: string; email: string };\r\n}\r\n\r\nexport default function AdminPayoutsPage() {\r\n    const [payouts, setPayouts] = useState<Payout[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [processing, setProcessing] = useState<string | null>(null);\r\n    const [filter, setFilter] = useState('ALL');\r\n\r\n    useEffect(() => {\r\n        fetchPayouts();\r\n    }, []);\r\n\r\n    const fetchPayouts = async () => {\r\n        try {\r\n            console.log('Fetching payouts...');\r\n            const res = await fetch('/api/payouts');\r\n            console.log('Fetch payouts response status:', res.status);\r\n\r\n            if (res.ok) {\r\n                const data = await res.json();\r\n                console.log('Fetch payouts data:', data);\r\n                setPayouts(data.payouts);\r\n            } else {\r\n                const errData = await res.json().catch(() => ({}));\r\n                console.error('Fetch payouts failed:', errData);\r\n                // Optional: alert('Failed to fetch payouts');\r\n            }\r\n        } catch (err) {\r\n            console.error('Failed to fetch payouts:', err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleAction = async (payoutId: string, action: 'APPROVE' | 'REJECT' | 'MARK_PAID') => {\r\n        setProcessing(payoutId);\r\n        try {\r\n            const res = await fetch(`/api/payouts/${payoutId}`, {\r\n                method: 'PUT',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ action }),\r\n            });\r\n\r\n            if (res.ok) {\r\n                fetchPayouts();\r\n            } else {\r\n                const data = await res.json();\r\n                alert(data.error || 'Failed to process payout');\r\n            }\r\n        } catch (err) {\r\n            alert('Failed to process payout');\r\n        } finally {\r\n            setProcessing(null);\r\n        }\r\n    };\r\n\r\n    const filteredPayouts = filter === 'ALL'\r\n        ? payouts\r\n        : payouts.filter(p => p.status === filter);\r\n\r\n    const totals = {\r\n        requested: payouts.filter(p => p.status === 'REQUESTED').reduce((sum, p) => sum + p.totalAmount, 0),\r\n        approved: payouts.filter(p => p.status === 'APPROVED').reduce((sum, p) => sum + p.totalAmount, 0),\r\n        paid: payouts.filter(p => p.status === 'PAID').reduce((sum, p) => sum + p.totalAmount, 0),\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex-center\" style={{ padding: '4rem' }}>\r\n                <div className=\"spinner\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"fade-in\">\r\n            <div className=\"page-header\">\r\n                <h1 className=\"page-title\">Payout Management</h1>\r\n                <p className=\"page-subtitle\">Review and process agent payout requests</p>\r\n            </div>\r\n\r\n            {/* Stats */}\r\n            <div className=\"grid grid-4\" style={{ marginBottom: 'var(--spacing-xl)' }}>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\">{payouts.length}</div>\r\n                    <div className=\"stat-label\">Total Requests</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--accent)' }}>\r\n                        â‚¹{totals.requested.toLocaleString()}\r\n                    </div>\r\n                    <div className=\"stat-label\">Pending Review</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--primary-light)' }}>\r\n                        â‚¹{totals.approved.toLocaleString()}\r\n                    </div>\r\n                    <div className=\"stat-label\">Approved (Unpaid)</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--secondary)' }}>\r\n                        â‚¹{totals.paid.toLocaleString()}\r\n                    </div>\r\n                    <div className=\"stat-label\">Total Paid</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Filters */}\r\n            <div className=\"flex gap-sm\" style={{ marginBottom: 'var(--spacing-xl)' }}>\r\n                {['ALL', 'REQUESTED', 'APPROVED', 'PAID', 'REJECTED'].map(status => (\r\n                    <button\r\n                        key={status}\r\n                        className={`btn btn-sm ${filter === status ? 'btn-primary' : 'btn-secondary'}`}\r\n                        onClick={() => setFilter(status)}\r\n                    >\r\n                        {status} ({payouts.filter(p => status === 'ALL' || p.status === status).length})\r\n                    </button>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Payouts Table */}\r\n            <div className=\"card\">\r\n                {filteredPayouts.length === 0 ? (\r\n                    <div className=\"empty-state\">\r\n                        <div className=\"empty-state-icon\">ðŸ’³</div>\r\n                        <p>No payout requests {filter !== 'ALL' ? `with status \"${filter}\"` : ''}</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"table-container\">\r\n                        <table>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Agent</th>\r\n                                    <th>Amount</th>\r\n                                    <th>Status</th>\r\n                                    <th>Requested</th>\r\n                                    <th>Actions</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {filteredPayouts.map(payout => (\r\n                                    <tr key={payout.id}>\r\n                                        <td>\r\n                                            <div style={{ fontWeight: 500 }}>{payout.agent?.name || 'Unknown'}</div>\r\n                                            <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>\r\n                                                {payout.agent?.email}\r\n                                            </div>\r\n                                        </td>\r\n                                        <td style={{ fontWeight: 600, color: 'var(--secondary)', fontSize: '1.125rem' }}>\r\n                                            â‚¹{payout.totalAmount.toLocaleString()}\r\n                                        </td>\r\n                                        <td>\r\n                                            <span className={`badge badge-${payout.status.toLowerCase()}`}>\r\n                                                {payout.status}\r\n                                            </span>\r\n                                        </td>\r\n                                        <td style={{ color: 'var(--text-muted)' }}>\r\n                                            {new Date(payout.requestedAt).toLocaleDateString()}\r\n                                        </td>\r\n                                        <td>\r\n                                            <div className=\"flex gap-sm\">\r\n                                                {payout.status === 'REQUESTED' && (\r\n                                                    <>\r\n                                                        <button\r\n                                                            onClick={() => handleAction(payout.id, 'APPROVE')}\r\n                                                            className=\"btn btn-success btn-sm\"\r\n                                                            disabled={processing === payout.id}\r\n                                                        >\r\n                                                            Approve\r\n                                                        </button>\r\n                                                        <button\r\n                                                            onClick={() => handleAction(payout.id, 'REJECT')}\r\n                                                            className=\"btn btn-danger btn-sm\"\r\n                                                            disabled={processing === payout.id}\r\n                                                        >\r\n                                                            Reject\r\n                                                        </button>\r\n                                                    </>\r\n                                                )}\r\n                                                {payout.status === 'APPROVED' && (\r\n                                                    <button\r\n                                                        onClick={() => handleAction(payout.id, 'MARK_PAID')}\r\n                                                        className=\"btn btn-primary btn-sm\"\r\n                                                        disabled={processing === payout.id}\r\n                                                    >\r\n                                                        Mark as Paid\r\n                                                    </button>\r\n                                                )}\r\n                                                {payout.status === 'PAID' && (\r\n                                                    <span style={{ color: 'var(--secondary)', fontSize: '0.875rem' }}>\r\n                                                        âœ“ Completed\r\n                                                    </span>\r\n                                                )}\r\n                                                {payout.status === 'REJECTED' && (\r\n                                                    <span style={{ color: 'var(--danger)', fontSize: '0.875rem' }}>\r\n                                                        âœ— Rejected\r\n                                                    </span>\r\n                                                )}\r\n                                            </div>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}