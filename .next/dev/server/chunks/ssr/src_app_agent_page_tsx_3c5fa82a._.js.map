{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/EDMAN/src/app/agent/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\n\r\ninterface Lead {\r\n    id: string;\r\n    studentName: string;\r\n    status: string;\r\n    createdAt: string;\r\n    course?: { name: string };\r\n}\r\n\r\ninterface CommissionTotals {\r\n    total: number;\r\n    pending: number;\r\n    paid: number;\r\n}\r\n\r\nexport default function AgentDashboard() {\r\n    const [leads, setLeads] = useState<Lead[]>([]);\r\n    const [commissionTotals, setCommissionTotals] = useState<CommissionTotals>({ total: 0, pending: 0, paid: 0 });\r\n    const [loading, setLoading] = useState(true);\r\n    const [agentId, setAgentId] = useState('');\r\n    const [origin, setOrigin] = useState('');\r\n\r\n    useEffect(() => {\r\n        setOrigin(window.location.origin);\r\n        fetchData();\r\n    }, []);\r\n\r\n    const fetchData = async () => {\r\n        try {\r\n            const [leadsRes, commissionsRes, meRes] = await Promise.all([\r\n                fetch('/api/leads'),\r\n                fetch('/api/commissions'),\r\n                fetch('/api/auth/me'),\r\n            ]);\r\n\r\n            if (leadsRes.ok) {\r\n                const leadsData = await leadsRes.json();\r\n                setLeads(leadsData.leads);\r\n            }\r\n\r\n            if (commissionsRes.ok) {\r\n                const commissionsData = await commissionsRes.json();\r\n                setCommissionTotals(commissionsData.totals);\r\n            }\r\n\r\n            if (meRes.ok) {\r\n                const meData = await meRes.json();\r\n                setAgentId(meData.user.id);\r\n            }\r\n        } catch (err) {\r\n            console.error('Failed to fetch data:', err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const getStatusCount = (status: string) =>\r\n        leads.filter(l => l.status === status).length;\r\n\r\n    const copyLink = () => {\r\n        const link = `${window.location.origin}/collect/${agentId}`;\r\n        navigator.clipboard.writeText(link);\r\n        alert('Link copied to clipboard!');\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex-center\" style={{ padding: '4rem' }}>\r\n                <div className=\"spinner\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"fade-in\">\r\n            <div className=\"page-header\">\r\n                <h1 className=\"page-title\">Agent Dashboard</h1>\r\n                <p className=\"page-subtitle\">Track your leads and earnings</p>\r\n            </div>\r\n\r\n            {/* Referral Link */}\r\n            <div className=\"card\" style={{ marginBottom: 'var(--spacing-xl)', borderLeft: '3px solid var(--primary)' }}>\r\n                <div className=\"flex-between\" style={{ flexWrap: 'wrap', gap: 'var(--spacing-md)' }}>\r\n                    <div>\r\n                        <h4 style={{ marginBottom: 'var(--spacing-sm)' }}>Your Referral Link</h4>\r\n                        <p style={{ color: 'var(--text-muted)', fontSize: '0.875rem' }}>\r\n                            Share this link to collect leads\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"url-input-group\">\r\n                        <input\r\n                            type=\"text\"\r\n                            value={agentId && origin ? `${origin}/collect/${agentId}` : ''}\r\n                            readOnly\r\n                            style={{ maxWidth: '400px' }}\r\n                        />\r\n                        <button onClick={copyLink} className=\"btn btn-primary btn-sm\">\r\n                            ðŸ“‹ Copy\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Stats Grid */}\r\n            <div className=\"grid grid-4\" style={{ marginBottom: 'var(--spacing-xl)' }}>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\">{leads.length}</div>\r\n                    <div className=\"stat-label\">Total Leads</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--primary-light)' }}>\r\n                        {getStatusCount('NEW') + getStatusCount('CONTACTED') + getStatusCount('INTERESTED')}\r\n                    </div>\r\n                    <div className=\"stat-label\">Active Leads</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--secondary)' }}>\r\n                        {getStatusCount('ENROLLED') + getStatusCount('CLOSED')}\r\n                    </div>\r\n                    <div className=\"stat-label\">Conversions</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\">â‚¹{commissionTotals.total.toLocaleString()}</div>\r\n                    <div className=\"stat-label\">Total Earnings</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Commission Overview */}\r\n            <div className=\"grid grid-3\" style={{ marginBottom: 'var(--spacing-xl)' }}>\r\n                <div className=\"card\" style={{ borderTop: '3px solid var(--accent)' }}>\r\n                    <h4 style={{ color: 'var(--accent)', marginBottom: 'var(--spacing-sm)' }}>Pending</h4>\r\n                    <div className=\"commission-amount\">â‚¹{commissionTotals.pending.toLocaleString()}</div>\r\n                    <p style={{ fontSize: '0.875rem', marginTop: 'var(--spacing-sm)' }}>Awaiting payout</p>\r\n                </div>\r\n                <div className=\"card\" style={{ borderTop: '3px solid var(--secondary)' }}>\r\n                    <h4 style={{ color: 'var(--secondary)', marginBottom: 'var(--spacing-sm)' }}>Paid</h4>\r\n                    <div className=\"commission-amount\" style={{ color: 'var(--secondary)' }}>\r\n                        â‚¹{commissionTotals.paid.toLocaleString()}\r\n                    </div>\r\n                    <p style={{ fontSize: '0.875rem', marginTop: 'var(--spacing-sm)' }}>Successfully withdrawn</p>\r\n                </div>\r\n                <div className=\"card\" style={{ borderTop: '3px solid var(--primary)' }}>\r\n                    <Link href=\"/agent/commissions\" className=\"btn btn-primary\" style={{ width: '100%' }}>\r\n                        ðŸ’° Request Payout\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Recent Leads */}\r\n            <div className=\"card\">\r\n                <div className=\"card-header\">\r\n                    <h3 className=\"card-title\">Recent Leads</h3>\r\n                    <Link href=\"/agent/leads\" className=\"btn btn-secondary btn-sm\">View All</Link>\r\n                </div>\r\n\r\n                {leads.length === 0 ? (\r\n                    <div className=\"empty-state\">\r\n                        <div className=\"empty-state-icon\">ðŸ‘¥</div>\r\n                        <p>No leads yet. Share your referral link to start collecting!</p>\r\n                        <Link href=\"/agent/collect\" className=\"btn btn-primary\" style={{ marginTop: 'var(--spacing-lg)' }}>\r\n                            âž• Add Your First Lead\r\n                        </Link>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"table-container\">\r\n                        <table>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Student Name</th>\r\n                                    <th>Course</th>\r\n                                    <th>Status</th>\r\n                                    <th>Date</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {leads.slice(0, 5).map(lead => (\r\n                                    <tr key={lead.id}>\r\n                                        <td style={{ fontWeight: 500 }}>{lead.studentName}</td>\r\n                                        <td>{lead.course?.name || 'N/A'}</td>\r\n                                        <td>\r\n                                            <span className={`badge badge-${lead.status.toLowerCase()}`}>\r\n                                                {lead.status}\r\n                                            </span>\r\n                                        </td>\r\n                                        <td style={{ color: 'var(--text-muted)' }}>\r\n                                            {new Date(lead.createdAt).toLocaleDateString()}\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}