{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/EDMAN/src/app/agent/commissions/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\ninterface Commission {\r\n    id: string;\r\n    amount: number;\r\n    status: string;\r\n    createdAt: string;\r\n    lead?: { id: string; studentName: string };\r\n    course?: { name: string; fee: number };\r\n}\r\n\r\ninterface Payout {\r\n    id: string;\r\n    totalAmount: number;\r\n    status: string;\r\n    requestedAt: string;\r\n    paidAt?: string;\r\n}\r\n\r\nexport default function AgentCommissionsPage() {\r\n    const [commissions, setCommissions] = useState<Commission[]>([]);\r\n    const [payouts, setPayouts] = useState<Payout[]>([]);\r\n    const [totals, setTotals] = useState({ total: 0, pending: 0, approved: 0, paid: 0 });\r\n    const [selectedCommissions, setSelectedCommissions] = useState<string[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [submitting, setSubmitting] = useState(false);\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n    }, []);\r\n\r\n    const fetchData = async () => {\r\n        try {\r\n            const [commissionsRes, payoutsRes] = await Promise.all([\r\n                fetch('/api/commissions'),\r\n                fetch('/api/payouts'),\r\n            ]);\r\n\r\n            if (commissionsRes.ok) {\r\n                const data = await commissionsRes.json();\r\n                setCommissions(data.commissions);\r\n                setTotals(data.totals);\r\n            }\r\n\r\n            if (payoutsRes.ok) {\r\n                const data = await payoutsRes.json();\r\n                setPayouts(data.payouts);\r\n            }\r\n        } catch (err) {\r\n            console.error('Failed to fetch data:', err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const toggleCommission = (id: string) => {\r\n        setSelectedCommissions(prev =>\r\n            prev.includes(id)\r\n                ? prev.filter(c => c !== id)\r\n                : [...prev, id]\r\n        );\r\n    };\r\n\r\n    const selectAllPending = () => {\r\n        const pendingIds = commissions\r\n            .filter(c => c.status === 'PENDING')\r\n            .map(c => c.id);\r\n        setSelectedCommissions(pendingIds);\r\n    };\r\n\r\n    const requestPayout = async () => {\r\n        if (selectedCommissions.length === 0) return;\r\n\r\n        setSubmitting(true);\r\n        try {\r\n            const res = await fetch('/api/payouts', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ commissionIds: selectedCommissions }),\r\n            });\r\n\r\n            if (res.ok) {\r\n                setSelectedCommissions([]);\r\n                fetchData();\r\n                alert('Payout request submitted successfully!');\r\n            } else {\r\n                const data = await res.json();\r\n                alert(data.error || 'Failed to submit payout request');\r\n            }\r\n        } catch (err) {\r\n            alert('Failed to submit payout request');\r\n        } finally {\r\n            setSubmitting(false);\r\n        }\r\n    };\r\n\r\n    const selectedTotal = commissions\r\n        .filter(c => selectedCommissions.includes(c.id))\r\n        .reduce((sum, c) => sum + c.amount, 0);\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex-center\" style={{ padding: '4rem' }}>\r\n                <div className=\"spinner\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"fade-in\">\r\n            <div className=\"page-header\">\r\n                <h1 className=\"page-title\">Commissions</h1>\r\n                <p className=\"page-subtitle\">Track your earnings and request payouts</p>\r\n            </div>\r\n\r\n            {/* Earnings Summary */}\r\n            <div className=\"grid grid-4\" style={{ marginBottom: 'var(--spacing-xl)' }}>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\">â‚¹{totals.total.toLocaleString()}</div>\r\n                    <div className=\"stat-label\">Total Earned</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--accent)' }}>\r\n                        â‚¹{totals.pending.toLocaleString()}\r\n                    </div>\r\n                    <div className=\"stat-label\">Available for Payout</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--primary-light)' }}>\r\n                        â‚¹{totals.approved.toLocaleString()}\r\n                    </div>\r\n                    <div className=\"stat-label\">Processing</div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <div className=\"stat-value\" style={{ color: 'var(--secondary)' }}>\r\n                        â‚¹{totals.paid.toLocaleString()}\r\n                    </div>\r\n                    <div className=\"stat-label\">Paid Out</div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid\" style={{ gridTemplateColumns: '2fr 1fr', gap: 'var(--spacing-xl)' }}>\r\n                {/* Commission List */}\r\n                <div className=\"card\">\r\n                    <div className=\"card-header\">\r\n                        <h3 className=\"card-title\">Commission History</h3>\r\n                        {commissions.some(c => c.status === 'PENDING') && (\r\n                            <button onClick={selectAllPending} className=\"btn btn-secondary btn-sm\">\r\n                                Select All Pending\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n\r\n                    {commissions.length === 0 ? (\r\n                        <div className=\"empty-state\">\r\n                            <div className=\"empty-state-icon\">ðŸ’°</div>\r\n                            <p>No commissions yet. Earn by closing leads!</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"table-container\">\r\n                            <table>\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th style={{ width: '40px' }}></th>\r\n                                        <th>Student</th>\r\n                                        <th>Course</th>\r\n                                        <th>Amount</th>\r\n                                        <th>Status</th>\r\n                                        <th>Date</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {commissions.map(commission => (\r\n                                        <tr key={commission.id}>\r\n                                            <td>\r\n                                                {commission.status === 'PENDING' && (\r\n                                                    <input\r\n                                                        type=\"checkbox\"\r\n                                                        checked={selectedCommissions.includes(commission.id)}\r\n                                                        onChange={() => toggleCommission(commission.id)}\r\n                                                        style={{ cursor: 'pointer' }}\r\n                                                    />\r\n                                                )}\r\n                                            </td>\r\n                                            <td style={{ fontWeight: 500 }}>\r\n                                                {commission.lead?.studentName || 'N/A'}\r\n                                            </td>\r\n                                            <td>{commission.course?.name || 'N/A'}</td>\r\n                                            <td style={{ fontWeight: 600, color: 'var(--secondary)' }}>\r\n                                                â‚¹{commission.amount.toLocaleString()}\r\n                                            </td>\r\n                                            <td>\r\n                                                <span className={`badge badge-${commission.status.toLowerCase()}`}>\r\n                                                    {commission.status}\r\n                                                </span>\r\n                                            </td>\r\n                                            <td style={{ color: 'var(--text-muted)' }}>\r\n                                                {new Date(commission.createdAt).toLocaleDateString()}\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Payout Request Panel */}\r\n                <div>\r\n                    <div className=\"card\" style={{ marginBottom: 'var(--spacing-lg)' }}>\r\n                        <h3 style={{ marginBottom: 'var(--spacing-lg)' }}>Request Payout</h3>\r\n\r\n                        <div style={{\r\n                            padding: 'var(--spacing-lg)',\r\n                            background: 'var(--bg-tertiary)',\r\n                            borderRadius: 'var(--radius-md)',\r\n                            marginBottom: 'var(--spacing-lg)'\r\n                        }}>\r\n                            <div style={{ fontSize: '0.875rem', color: 'var(--text-muted)' }}>\r\n                                Selected Amount\r\n                            </div>\r\n                            <div className=\"commission-amount\">\r\n                                â‚¹{selectedTotal.toLocaleString()}\r\n                            </div>\r\n                            <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginTop: 'var(--spacing-sm)' }}>\r\n                                {selectedCommissions.length} commission(s) selected\r\n                            </div>\r\n                        </div>\r\n\r\n                        <button\r\n                            onClick={requestPayout}\r\n                            className=\"btn btn-success\"\r\n                            style={{ width: '100%' }}\r\n                            disabled={selectedCommissions.length === 0 || submitting}\r\n                        >\r\n                            {submitting ? 'Submitting...' : 'Request Payout'}\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Payout History */}\r\n                    <div className=\"card\">\r\n                        <h3 style={{ marginBottom: 'var(--spacing-lg)' }}>Payout History</h3>\r\n\r\n                        {payouts.length === 0 ? (\r\n                            <p style={{ color: 'var(--text-muted)', fontSize: '0.875rem' }}>\r\n                                No payout requests yet\r\n                            </p>\r\n                        ) : (\r\n                            <div style={{ display: 'flex', flexDirection: 'column', gap: 'var(--spacing-md)' }}>\r\n                                {payouts.slice(0, 5).map(payout => (\r\n                                    <div\r\n                                        key={payout.id}\r\n                                        style={{\r\n                                            padding: 'var(--spacing-md)',\r\n                                            background: 'var(--bg-tertiary)',\r\n                                            borderRadius: 'var(--radius-md)'\r\n                                        }}\r\n                                    >\r\n                                        <div className=\"flex-between\">\r\n                                            <span style={{ fontWeight: 600 }}>\r\n                                                â‚¹{payout.totalAmount.toLocaleString()}\r\n                                            </span>\r\n                                            <span className={`badge badge-${payout.status.toLowerCase()}`}>\r\n                                                {payout.status}\r\n                                            </span>\r\n                                        </div>\r\n                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginTop: 'var(--spacing-xs)' }}>\r\n                                            Requested: {new Date(payout.requestedAt).toLocaleDateString()}\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}